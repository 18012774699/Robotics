# 动态环境感知与跟踪

## 跟踪算法简介

![](.\image3\Tracking.png)



## 单目标跟踪

![](.\image3\单目标跟踪算法.png)

### 产生式模型

#### Mean-Shift

来源：https://blog.csdn.net/jzwong/article/details/78830600

https://blog.csdn.net/maweifei/article/details/78766784

https://www.doc88.com/p-1973064119941.html

- 对目标建模（比如利用目标的颜色直方图来描述目标），计算目标在下一帧图像上的概率分布
- 沿着概率梯度上升的方向，迭代收敛到概率密度分布的局部峰值上
- 适用于目标色彩模型和背景差异比较大的情形，计算速度快



#### 基于特征点的光流跟踪算法

**一、基于特征点的目标跟踪的一般方法**

   基于特征点的跟踪算法大致可以分为两个步骤：

   1）探测当前帧的特征点（ 本文用改进的[Harris角点算法](http://blog.csdn.net/crzy_sparrow/article/details/7391511)提取特征点）；

   2）通过当前帧和下一帧**灰度比较**，估计当前帧特征点在下一帧的位置（用Lucas-Kanade光流法实现目标跟踪）；

   3）过滤位置不变的特征点，余下的点就是目标了。

   很显然，基于特征点的目标跟踪算法和1），2）两个步骤有关。特征点可以是**Harris角点**，也可以是**边缘点**等等，而估计下一帧位置的方法也有不少，比如这里要讲的**光流法**，也可以是**卡尔曼滤波法**。

> 来源：https://blog.csdn.net/u010141025/article/details/14769933

**二、Lucas-Kanade光流**

1.首先是假设条件：

​    （1）**亮度恒定**，就是同一点随着时间的变化，其亮度不会发生改变。这是基本光流法的假定。

​    （2）**小运动**，就是时间的变化不会引起位置的剧烈变化，这也是光流法不可或缺的假定；

​    （3）**空间一致**，一个场景上邻近的点投影到图像上也是邻近点。

2.多尺度（对每一帧建立一个高斯金字塔）能解决，**小运动和孔径问题**，但还是有很多限制，鲁棒性差。



#### Kalman Filter**

- **核心思想**：**观测值**并不一定精确，实际**估计值**应该是对于**预测值**和**观测值**的加权平均

$$
X_{update}=X_{predict}+g(X_{observation}-X_{predict}),\ 0<=g<=1
$$

- **卡尔曼滤波的两个典型方程**：

$$
X_k=AX_{k−1}+Bu_k+W_{k−1}\\
Z_k=HX_k+v_k
$$


第一个公式是**运动方程**，意味着每个x_k可以通过一个线性随机方程来表示。任何一个x_k都是它前一状态的的只加上控制信号u_k及处理噪声W_{k−1}的线性组合。大多数的情况下，并不需要控制信号u_k。

第二个公式是**观测方程**，任何测量值（这里我们并不确定它是否准确）是当前状态信号值及测量噪声的线性组合，我们默认该值服从高斯分布。

- **运动方程和观测方程合并**：通过上次**估计值**和这次**测量值**计算出这次**估计值**

![](.\image3\卡尔曼滤波.gif)

> **笔记**
>
> - 状态域*观测矩矩阵H=观测域，状态域（后端数据） <=> 观测域（前端结果）
> - K_k指卡尔曼增益，包含融合因子g和观测矩阵H
> - 协方差矩阵∑：表示系统中的不确定性
>
> 见视频：https://www.bilibili.com/video/av89425879?p=6
>

![](.\image3\卡尔曼滤波_openCV.png)

#### Particle Filter

1、对跟踪目标建模（例如颜色直方图）得到目标特征表达

2、均匀分布撒下一些“粒子”，提取“粒子”附近的特征，比较与目标特征的匹配程度

3、有些狗发现目标踪迹，有些没有发现。重新部署到发现踪迹的位置。并按照高斯分布的方式在可疑点附近撒下更多粒子。



### 鉴别式模型**

![](.\image3\鉴别式模型.png)

### 基于相关滤波的跟踪算法**

- 循环矩阵
- 分类器的学习过程可以用快速傅里叶变换转换成频域内的计算整个学习过程十分高效
- 实时性高

#### MOSSE

#### KCF



### 基于深度学习的跟踪算法



### 更多

![](.\image3\单目标跟踪算法2.png)



## 多目标跟踪

![](.\image3\多目标跟踪.png)

### 二分图匹配

- 二分图中计算相似度**矩阵**，用于之后可匹配性
- **匈牙利算法**计算**最大匹配**
- 没有跟踪上的新建一个框





